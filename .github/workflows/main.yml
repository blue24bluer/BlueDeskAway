name: RDP over Serveo

on:
  workflow_dispatch:

jobs:
  serveo-vnc:
    runs-on: ubuntu-latest
    timeout-minutes: 360

    steps:
    - name: 🧰 Install Desktop + VNC
      run: |
        sudo apt update
        sudo apt install -y xfce4 xfce4-goodies tightvncserver openssh-client
        mkdir -p ~/.vnc
        echo "mysecurepass" | vncpasswd -f > ~/.vnc/passwd
        chmod 600 ~/.vnc/passwd
        echo "#!/bin/bash
        startxfce4 &" > ~/.vnc/xstartup
        chmod +x ~/.vnc/xstartup
        vncserver :1

    - name: 🔗 Create tunnel using Serveo
      run: |
        ssh -o StrictHostKeyChecking=no -R 5900:localhost:5901 serveo.net &
        sleep 30
        echo "✅ افتح VNC على: serveo.net:5900 بكلمة المرور: mysecurepass"
        sleep 320m
