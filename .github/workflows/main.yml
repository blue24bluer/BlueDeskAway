name: VNC with LocalXpose

on:
  workflow_dispatch:

jobs:
  vnc-server:
    runs-on: ubuntu-latest
    timeout-minutes: 360

    steps:
    - name: ğŸ§° Install XFCE + VNC
      run: |
        sudo apt update
        sudo apt install -y xfce4 xfce4-goodies tightvncserver wget unzip curl
        mkdir -p ~/.vnc
        echo "mysecurepass" | vncpasswd -f > ~/.vnc/passwd
        chmod 600 ~/.vnc/passwd
        echo "#!/bin/bash
        startxfce4 &" > ~/.vnc/xstartup
        chmod +x ~/.vnc/xstartup
        vncserver :1

    - name: ğŸ”— Install & Start LocalXpose Tunnel
      run: |
        wget https://github.com/localxpose/cli/releases/latest/download/localxpose-linux-amd64.zip
        unzip localxpose-linux-amd64.zip
        chmod +x lx
        ./lx authtoken rE9mIkydSoKxj1eZK3nAaGCfcdLTFn5xMN8mnFSR
        ./lx tcp --port 5901 --region eu &
        sleep 20
        echo "âœ… VNC Tunnel Started on LocalXpose - Ø§Ø³ØªØ®Ø¯Ù… VNC Ø¨Ù€ IP Ø§Ù„Ø¸Ø§Ù‡Ø± Ù„Ø§Ø­Ù‚Ù‹Ø§"

    - name: â³ Keep the session alive
      run: sleep 320m
